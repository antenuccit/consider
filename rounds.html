{% extends "admin_base.html" %}
{% block title %}Rounds{% endblock %}

{% block content %}
<h1 class="page-header">Rounds - {{section}}</h1>
<h4 class="sub-header">Current round: {% if round -%} {{round}} {% else -%} No rounds in progress {%- endif -%}</h4>
<form class="form-horizontal" id="form" method="post" style="text-align: center;" action="/rounds">
    <div class="form-group">
      <label for="inputTime1" class="lead col-sm-4 control-label">Set time for round 1:</label>
      <div class="col-sm-4">
        <input type="datetime-local" class="form-control" id="inputTime1" name="time" required="true">
      </div>
    </div>
    <div class="form-group">
        <button type="submit" class="btn btn-default">Start round 1</button>
    </div>
</form>
<form class="form-horizontal" id="form2" method="post" style="text-align: center;" action="/rounds">
    <div class="form-group">
      <label for="inputTime2" class="lead col-sm-4 control-label">Set time for round 2:</label>
      <div class="col-sm-4">
        <input type="datetime-local" class="form-control" id="inputTime2" name="time" required="true">
      </div>
    </div>
    <div class="form-group">
        <button type="submit" class="btn btn-default">Start round 2</button>
    </div>
</form>
<h4 class="sub-header">Previous rounds:</h4>
{% endblock %}

{% block script %}
<script>
  $("#form").submit(function (event) {
        //Prevent the default behaviour
        event.preventDefault();

        //collect form elements
        var $form = $(this),
        time_val = $form.find("input[name='time']").val(),
        class2 = "{{section}}",
        url = $form.attr("action");

        // do the POST and get the callback
        $.post(url,{time:time_val, class:class2, round:1},function (data) {
          bootbox.alert(data);
        });
      });

  $("#form2").submit(function (event) {
        //Prevent the default behaviour
        event.preventDefault();

        //collect form elements
        var $form = $(this),
        time_val = $form.find("input[name='time']").val(),
        class2 = "{{section}}",
        url = $form.attr("action");

        // do the POST and get the callback
        $.post(url,{time:time_val, class:class2, round:2},function (data) {
          bootbox.alert(data);
        });
      });
</script>
{% endblock %}